- block:
    - name: Install git-review
      package:
        name:
          - git-review
          - catatonit
        state: present
      become: true
    - name: Start buildx builder
      # https://github.com/docker/buildx/issues/344
      # https://bugs.launchpad.net/ubuntu/+source/libpod/+bug/2040483
      shell: |
        systemctl stop apparmor.service || true
        systemctl disable apparmor.service || true
        aa-teardown || true
        echo "FROM scratch" | docker buildx build - || true
      environment:
        DOCKER_HOST: unix:///run/podman/podman.sock
      become: true
  when: not local

- name: Setup Tutorial Execution
  include_role:
    name: setup-tutorial

- name: Run quick-start tutorial
  include_tasks: quick-start.yaml

- name: Run admin tutorial
  include_tasks: admin.yaml

- name: Run tracing tutorial
  include_tasks: tracing.yaml
