- hosts: all
  roles:
    - revoke-sudo
    - set-zuul-log-path-fact
    # TODO(mordred) It's not great embedding logs.openstack.org here
    # The double quotes are required. The "" quotes are for the shell, but we
    # need the '' quotes because webpack takes the entire contents of the
    # variable and injects it directly. SO ...
    #   define ZUUL_API_URL="'https://zuul.openstack.org'"
    # results in
    #   var ZUUL_API_URL = 'https://zuul.openstack.org'
    # in the injected/generated javascript.
    - role: npm
      npm_command: >-
        build:dist --
          --define ZUUL_API_URL="'https://zuul.openstack.org'"
          --define ZUUL_BASE_HREF="'http://logs.openstack.org/{{ zuul_log_path }}/npm/html'"
