{
  "comments": [
    {
      "key": {
        "uuid": "0c7e0ffd_46ba301f",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 907,
      "author": {
        "id": 4146
      },
      "writtenOn": "2021-07-07T23:57:59Z",
      "side": 1,
      "message": "The old not smart reconfiguration loaded AdminRules first then TPCs. I\u0027m not sure that order matters here, but thought I would call out the difference in case it does.",
      "revId": "04e9075ca9860c8652c4a615a63ff5ab7b7b585e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6a86cc95_ae1ec63d",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 907,
      "author": {
        "id": 1
      },
      "writtenOn": "2021-07-08T00:11:23Z",
      "side": 1,
      "message": "I think they are distinct enough it should not matter.",
      "revId": "04e9075ca9860c8652c4a615a63ff5ab7b7b585e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "554eedd4_c11facd1",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 911,
      "author": {
        "id": 4146
      },
      "writtenOn": "2021-07-07T23:57:59Z",
      "side": 1,
      "message": "The old code doesn\u0027t seem to do this but I think that is because it created an entirely new abide. Now that we reuse the abide we need to reset the cache.",
      "revId": "04e9075ca9860c8652c4a615a63ff5ab7b7b585e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a609dc97_e753791e",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 911,
      "author": {
        "id": 27582
      },
      "writtenOn": "2021-07-08T06:57:52Z",
      "side": 1,
      "message": "Yes, correct.",
      "parentUuid": "554eedd4_c11facd1",
      "revId": "04e9075ca9860c8652c4a615a63ff5ab7b7b585e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1253ec33_e9031410",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 926,
      "author": {
        "id": 4146
      },
      "writtenOn": "2021-07-07T23:57:59Z",
      "side": 1,
      "message": "I\u0027m not seeing anything that removes tenants that are no longer present from abide.tenants. Where is that happening for full reconfigurations?",
      "revId": "04e9075ca9860c8652c4a615a63ff5ab7b7b585e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "326863fb_ae4e7e46",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 926,
      "author": {
        "id": 1
      },
      "writtenOn": "2021-07-08T00:11:23Z",
      "side": 1,
      "message": "I agree that seems to be missing.  We should add the following test cases:\n\n* Add a tenant (1 -\u003e 2 tenants)\n* Delete a tenant (2 -\u003e 1 tenants)\n\nI can\u0027t find any existing tests that do that (but that doesn\u0027t mean they don\u0027t exist).",
      "revId": "04e9075ca9860c8652c4a615a63ff5ab7b7b585e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "724b3bcc_261eeb4a",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 926,
      "author": {
        "id": 16068
      },
      "writtenOn": "2021-07-08T06:56:56Z",
      "side": 1,
      "message": "The test_smart_reconfiguration test case adds and removes tenants. If we want that to be tested on full reconfigs I think this can be duplicated for full reconfigs.",
      "parentUuid": "326863fb_ae4e7e46",
      "revId": "04e9075ca9860c8652c4a615a63ff5ab7b7b585e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a403c21a_ba65fd5b",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 926,
      "author": {
        "id": 27582
      },
      "writtenOn": "2021-07-08T06:57:52Z",
      "side": 1,
      "message": "Tenants that are no longer present are removed here: https://opendev.org/zuul/zuul/src/branch/master/zuul/configloader.py#L2294\n\nI\u0027ll try to see if there is already an existing test case or add one of this is not yet covered.",
      "parentUuid": "326863fb_ae4e7e46",
      "revId": "04e9075ca9860c8652c4a615a63ff5ab7b7b585e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ed341811_7aeb6a55",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 937,
      "author": {
        "id": 4146
      },
      "writtenOn": "2021-07-07T23:57:59Z",
      "side": 1,
      "message": "I guess this log info is only useful in the smart case because a non smart reconfigure does all tenants?",
      "revId": "04e9075ca9860c8652c4a615a63ff5ab7b7b585e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4ce4bb95_b3750a60",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 937,
      "author": {
        "id": 27582
      },
      "writtenOn": "2021-07-08T06:57:52Z",
      "side": 1,
      "message": "It wouldn\u0027t hurt also logging the tenants in case of a full reconfiguration, but yes it\u0027s mostly useful for smart reconfigurations.",
      "parentUuid": "ed341811_7aeb6a55",
      "revId": "04e9075ca9860c8652c4a615a63ff5ab7b7b585e",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": true
    }
  ]
}