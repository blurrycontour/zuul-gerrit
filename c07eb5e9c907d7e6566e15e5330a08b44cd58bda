{
  "comments": [
    {
      "key": {
        "uuid": "1a1ced50_f3254ac2",
        "filename": ".zuul.yaml",
        "patchSetId": 8
      },
      "lineNbr": 9,
      "author": {
        "id": 1
      },
      "writtenOn": "2017-03-17T22:17:36Z",
      "side": 1,
      "message": "Should this have /workspace on the end?",
      "revId": "c07eb5e9c907d7e6566e15e5330a08b44cd58bda",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a1ced50_d3404e59",
        "filename": "playbooks/roles/prepare-workspace/defaults/main.yaml",
        "patchSetId": 8
      },
      "lineNbr": 2,
      "author": {
        "id": 1
      },
      "writtenOn": "2017-03-17T22:17:36Z",
      "side": 1,
      "message": "Why not just use \"zuul_workspace_root\" here?  That seems sufficiently unique considering the expected scope of this role.  Reduces some extra plumbing and avoids an extra-long variable name.",
      "revId": "c07eb5e9c907d7e6566e15e5330a08b44cd58bda",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a1ced50_6e1251b6",
        "filename": "playbooks/roles/prepare-workspace/defaults/main.yaml",
        "patchSetId": 8
      },
      "lineNbr": 2,
      "author": {
        "id": 4162
      },
      "writtenOn": "2017-03-17T22:41:18Z",
      "side": 1,
      "message": "Let me preface, as this is completely personal opinion and something I\u0027ve wanted to at-least get into some sort of design document for playbook / roles.\n\nI have a strong desire to implement / encore some sort of variable scoping for our roles.  Specifically, a role should only access local variables itself.  I know there is nothing stopping you to do this in ansible today (and more something specific to how puppet does variables) but I see it as a good way to implement some sort of interface for roles. It also should help protect us from spaghetti dependencies with roles.\n\nFor me, I\u0027ve been writing role variables with the following in mind, \u003crole name\u003e_\u003cvariable name\u003e. I the case here, prepare_workspace is the role, workspace_root the local variable.  This was part of my motivation at rename the role to bootstrap, so it didn\u0027t look weird.\n\nAdditionally, this patchset is a little bad because it doesn\u0027t completely follow what I just typed in the run-cover role, since it is accessing zuul_workspace_root directly.\n\nI can hopefully better demonstrate it with some existing code:\n\n  http://git.openstack.org/cgit/openstack/ansible-role-shade/tree/defaults/main.yaml\n  http://git.openstack.org/cgit/openstack/windmill/tree/playbooks/group_vars/nodepool-launcher.yaml\n\nPerhaps I am being a little paranoid, or making additional work, but I am concerned about how easier it is to group everything into a global vars.  Especially if every get to the point of separate repos for ansible roles.",
      "parentUuid": "1a1ced50_d3404e59",
      "revId": "c07eb5e9c907d7e6566e15e5330a08b44cd58bda",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a1ced50_ae444974",
        "filename": "playbooks/roles/prepare-workspace/defaults/main.yaml",
        "patchSetId": 8
      },
      "lineNbr": 2,
      "author": {
        "id": 1
      },
      "writtenOn": "2017-03-17T22:56:49Z",
      "side": 1,
      "message": "I think that\u0027s reasonable.  The goal is to make things more comprehensible.  Like most strict rules, there may be some situations where it results in the opposite, and I think that\u0027s what we\u0027re seeing here.  \"prepare_workspace_workspace_root\" is very confusing, and in order to make it less confusing, we considered changing the name of the role -- however, that made that *role* more confusing.  That\u0027s why I think this merits re-examining the rule to see if it\u0027s a good fit here.\n\nI think the workspace root is going to be used by *a lot* of roles, and I think passing it around to each of them is going to make for a lot of boilerplate and will turn people off from wanting to write jobs.  That\u0027s why my preference is to just accept that this one should be global.\n\nOne of the things I\u0027m sure we both would like to avoid, however, is something like this leaking into non-zuul-specific playbook content.  For instance, if a devstack deployment script directly referenced zuul_workspace_root, that would be unfortunate, because while it may *want* a working directory, there\u0027s nothing zuul-specific about it, and that\u0027s definitely a case where I agree we should have a \"devstack_workspace_root: {{zuul_workspace_root}}\" variable definition.\n\nI\u0027m very sympathetic to that line of thinking, and if you and others feel strongly that we need to explicitly demarcate all of the role variables, maybe we could at least make it a bit cleaner here with a different name like \"prepare_workspace_root\".  It\u0027s also worth keeping in mind that we can write:\n  roles:\n    - role: prepare-workspace\n      root: {{zuul_workspace_root}\nif we wanted to shorten it further.",
      "revId": "c07eb5e9c907d7e6566e15e5330a08b44cd58bda",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    }
  ]
}