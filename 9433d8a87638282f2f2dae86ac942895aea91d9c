{
  "comments": [
    {
      "key": {
        "uuid": "5f7c97a3_0d2f0af5",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 82,
      "author": {
        "id": 1
      },
      "writtenOn": "2018-07-10T20:25:34Z",
      "side": 1,
      "message": "We should add docs for the new args.",
      "revId": "9433d8a87638282f2f2dae86ac942895aea91d9c",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5f7c97a3_2d32065e",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 996,
      "author": {
        "id": 1
      },
      "writtenOn": "2018-07-10T20:25:34Z",
      "side": 1,
      "message": "I would find it easier to follow if we put the new logic here (it\u0027s getting log enough, we should probably make this another method).  We already have some logic here that decides that we should reconfigure the tenant.  This change adds some more logic in a different place.  I think it would be better if it were all together.  Then once the decision is made, an event is added to the queue.\n\nI think you should be able to do that by peeking into the unparsed config cache here.",
      "revId": "9433d8a87638282f2f2dae86ac942895aea91d9c",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5f7c97a3_8a19b788",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 996,
      "author": {
        "id": 16068
      },
      "writtenOn": "2018-07-11T04:12:44Z",
      "side": 1,
      "message": "This was in fact Markus\u0027 first idea but I feared this might create a risk for races due to delayed execution of the tenant reconfiguration and merging of tenant reconfiguration events (here we just add the event to the event queue). So adding the skip later was the safe way to avoid that possibility.\n\nIf we come to the conclusion that this is not a problem here I\u0027m fine moving the check here (it probably even simplifies this change significantly).",
      "parentUuid": "5f7c97a3_2d32065e",
      "revId": "9433d8a87638282f2f2dae86ac942895aea91d9c",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5f7c97a3_7b7dfce4",
        "filename": "zuul/scheduler.py",
        "patchSetId": 2
      },
      "lineNbr": 996,
      "author": {
        "id": 1
      },
      "writtenOn": "2018-07-11T20:44:20Z",
      "side": 1,
      "message": "Since currently the event is added and consumed within the single scheduler thread, I don\u0027t think there\u0027s a risk of a race.  We would need to think about that in the future if something outside the loop submits a TenantReconfigurationEvent.  It\u0027s hard to say what the risk of a race might be in that place, but still, I think that having the logic in one place will at least make that easier to evaluate.",
      "revId": "9433d8a87638282f2f2dae86ac942895aea91d9c",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    }
  ]
}