{
  "comments": [
    {
      "key": {
        "uuid": "bab6814e_9433e461",
        "filename": "zuul/model.py",
        "patchSetId": 3
      },
      "lineNbr": 1410,
      "author": {
        "id": 7069
      },
      "writtenOn": "2016-05-20T01:24:58Z",
      "side": 1,
      "message": "Do we want a lock on this method to avoid two saves()\u0027s both writing to the .tmp file while it\u0027s being moved into place?",
      "range": {
        "startLine": 1410,
        "startChar": 8,
        "endLine": 1410,
        "endChar": 15
      },
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bab6814e_917c72b6",
        "filename": "zuul/model.py",
        "patchSetId": 3
      },
      "lineNbr": 1410,
      "author": {
        "id": 1
      },
      "writtenOn": "2016-05-20T15:26:11Z",
      "side": 1,
      "message": "This is not currently thread-safe, which is why it\u0027s only called from within the main scheduling loop.  That will ensure no locking is needed.  If we decide to use it from outside, then yes, we should add a lock.\n\n(For the most part, zuul attempts to avoid locks, so I have kept that pattern here.)",
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bab6814e_87f523ee",
        "filename": "zuul/model.py",
        "patchSetId": 3
      },
      "lineNbr": 1410,
      "author": {
        "id": 7069
      },
      "writtenOn": "2016-05-23T09:08:45Z",
      "side": 1,
      "message": "If a race here were created it\u0027d be so slim that\u0027d it be very difficult to track down. I think we should do it now while we think of it rather than running into it later.\n\nHowever, this is an opinion and not a -1.",
      "parentUuid": "bab6814e_917c72b6",
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bab6814e_0604ee15",
        "filename": "zuul/model.py",
        "patchSetId": 3
      },
      "lineNbr": 1410,
      "author": {
        "id": 1
      },
      "writtenOn": "2016-05-25T20:34:25Z",
      "side": 1,
      "message": "I think it\u0027s important for zuul developers to understand that the expectation is that everything associated with the scheduler runs in the main loop, and the queues are responsible for serializing and locking.  There are good reasons for that, and the lack of locking associated with it, and I don\u0027t really want to change that in this patch.",
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bab6814e_74b3e0e9",
        "filename": "zuul/model.py",
        "patchSetId": 3
      },
      "lineNbr": 1446,
      "author": {
        "id": 7069
      },
      "writtenOn": "2016-05-20T01:24:58Z",
      "side": 1,
      "message": "Should we should append project_name and job_name to make up the TimeData?\n\nIf two jobs are named the same but ran on different projects do we want to time them differently? Perhaps at the moment while jobs are uniquely named for each project it doesn\u0027t matter (and those sharing names are expected to run the same way no matter the project against).",
      "range": {
        "startLine": 1446,
        "startChar": 27,
        "endLine": 1446,
        "endChar": 31
      },
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bab6814e_f14b3e85",
        "filename": "zuul/model.py",
        "patchSetId": 3
      },
      "lineNbr": 1446,
      "author": {
        "id": 1
      },
      "writtenOn": "2016-05-20T15:26:11Z",
      "side": 1,
      "message": "Yeah, I believe the job name is sufficiently unique for v2.  We will need to change that in v3.",
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bab6814e_a7402708",
        "filename": "zuul/model.py",
        "patchSetId": 3
      },
      "lineNbr": 1446,
      "author": {
        "id": 7069
      },
      "writtenOn": "2016-05-23T09:08:45Z",
      "side": 1,
      "message": "There is a chance that somebody adds a job with the same name to multiple projects and we don\u0027t realise it. For this reason, should we protect it here anyway since it\u0027s trivial?",
      "parentUuid": "bab6814e_f14b3e85",
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bab6814e_e600ca04",
        "filename": "zuul/model.py",
        "patchSetId": 3
      },
      "lineNbr": 1446,
      "author": {
        "id": 1
      },
      "writtenOn": "2016-05-25T20:34:25Z",
      "side": 1,
      "message": "In zuulv2, if someone adds a job with the same name to multiple projects, they have added one job to multiple projects.  I.e., the two jobs are the same job, so this behavior is correct.",
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bab6814e_14f094c8",
        "filename": "zuul/model.py",
        "patchSetId": 3
      },
      "lineNbr": 1450,
      "author": {
        "id": 7069
      },
      "writtenOn": "2016-05-20T01:24:58Z",
      "side": 1,
      "message": "The JobTimeData object holds all of its own state. We probably don\u0027t want to load it from disk again each time we want to know the running time. We should only need to load() when we instantiate a new instance of JobTimeData.",
      "range": {
        "startLine": 1450,
        "startChar": 11,
        "endLine": 1450,
        "endChar": 15
      },
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bab6814e_d150ba34",
        "filename": "zuul/model.py",
        "patchSetId": 3
      },
      "lineNbr": 1450,
      "author": {
        "id": 1
      },
      "writtenOn": "2016-05-20T15:26:11Z",
      "side": 1,
      "message": "Agreed, that was what I intended, so this is an indentation failure.  Thanks.",
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bab6814e_54c97c25",
        "filename": "zuul/scheduler.py",
        "patchSetId": 3
      },
      "lineNbr": 747,
      "author": {
        "id": 7069
      },
      "writtenOn": "2016-05-20T01:24:58Z",
      "side": 1,
      "message": "Should probably document this option",
      "range": {
        "startLine": 747,
        "startChar": 43,
        "endLine": 747,
        "endChar": 52
      },
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bab6814e_3142e668",
        "filename": "zuul/scheduler.py",
        "patchSetId": 3
      },
      "lineNbr": 747,
      "author": {
        "id": 1
      },
      "writtenOn": "2016-05-20T15:26:11Z",
      "side": 1,
      "message": "It is an existing and documented option.",
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bab6814e_5414dc9e",
        "filename": "zuul/scheduler.py",
        "patchSetId": 3
      },
      "lineNbr": 754,
      "author": {
        "id": 7069
      },
      "writtenOn": "2016-05-20T01:24:58Z",
      "side": 1,
      "message": "consider makedirs?",
      "range": {
        "startLine": 754,
        "startChar": 15,
        "endLine": 754,
        "endChar": 20
      },
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bab6814e_1147e277",
        "filename": "zuul/scheduler.py",
        "patchSetId": 3
      },
      "lineNbr": 754,
      "author": {
        "id": 1
      },
      "writtenOn": "2016-05-20T15:26:11Z",
      "side": 1,
      "message": "We have not made the state dir itself previously, but rather assumed it existed.  We could consider changing that, but I think that\u0027s a further change than necessary here.",
      "revId": "b7aadc382cb3a1a034c9a4824b8dc4d1aa3ad952",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    }
  ]
}