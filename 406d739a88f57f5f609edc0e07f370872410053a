{
  "comments": [
    {
      "key": {
        "uuid": "c6fcab82_385394ed",
        "filename": "tests/base.py",
        "patchSetId": 5
      },
      "lineNbr": 5217,
      "author": {
        "id": 1
      },
      "writtenOn": "2021-07-29T01:23:49Z",
      "side": 1,
      "message": "Can use .all() here",
      "revId": "406d739a88f57f5f609edc0e07f370872410053a",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "02030583_5202eb76",
        "filename": "tests/unit/test_configloader.py",
        "patchSetId": 5
      },
      "lineNbr": 330,
      "author": {
        "id": 1
      },
      "writtenOn": "2021-07-29T01:23:49Z",
      "side": 1,
      "message": "This could be:\n  cat_jobs \u003d self.merge_job_history[MergeRequest.CAT]\n\nThere\u0027s a subtle difference between these: the old is getting all of the merge jobs from any source, the new is getting all of the merge jobs submitted by the schedulers.  They should be equivalent since only the schedulers should submit merge jobs.  But it\u0027s a difference to be aware of (perhaps in the case of a test that submits a merge job directly).",
      "revId": "406d739a88f57f5f609edc0e07f370872410053a",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9b139e9e_ea6e0edc",
        "filename": "zuul/merger/server.py",
        "patchSetId": 5
      },
      "lineNbr": 190,
      "author": {
        "id": 1
      },
      "writtenOn": "2021-07-29T02:58:29Z",
      "side": 1,
      "message": "The name \"MergerWorker\" is a bit confusing.  Previously, the Merger was implemented as a gearman Worker, so that\u0027s why the \"worker\" was started by the \"merger\".\n\nBut now we really just have the main merger thread; there aren\u0027t two distinct components.  I think we can drop the word \"worker\" from ewherewhere it\u0027s used (or maybe in some cases, like self.merger_worker change it to self.merger_thread).",
      "revId": "406d739a88f57f5f609edc0e07f370872410053a",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b4f88d75_0a4d32e0",
        "filename": "zuul/merger/server.py",
        "patchSetId": 5
      },
      "lineNbr": 192,
      "author": {
        "id": 1
      },
      "writtenOn": "2021-07-29T01:23:49Z",
      "side": 1,
      "message": "We should check if we\u0027re running after the wait, otherwise we might pick up a job (if one arrives just after we are requested to stop).",
      "revId": "406d739a88f57f5f609edc0e07f370872410053a",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "afae1abc_a37b332f",
        "filename": "zuul/merger/server.py",
        "patchSetId": 5
      },
      "lineNbr": 192,
      "author": {
        "id": 1
      },
      "writtenOn": "2021-07-29T02:44:30Z",
      "side": 1,
      "message": "Disregard this comment, the check after we enter the iterator is sufficient.",
      "revId": "406d739a88f57f5f609edc0e07f370872410053a",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f7efe20a_63cb5510",
        "filename": "zuul/merger/server.py",
        "patchSetId": 5
      },
      "lineNbr": 197,
      "author": {
        "id": 1
      },
      "writtenOn": "2021-07-29T02:58:29Z",
      "side": 1,
      "message": "There is no exception handling within the merger thread, so if any job raises an exception, the thread will exit.  Previously, the gearman worker handled that for us, but now we need to do it.\n\nBasically, any exception in self._runMergerWorker (which I suggest renaming to _runMergeJob) should still report completion (but also, failure).  And separately, if that report has an error, it should log it and continue.  The thread should never exit unless explicitly requested.\n\nIt\u0027s possible this is what\u0027s causing the test errors, but I still haven\u0027t caught it in logs.",
      "revId": "406d739a88f57f5f609edc0e07f370872410053a",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2f3d2cdd_3ef7e0e7",
        "filename": "zuul/merger/server.py",
        "patchSetId": 5
      },
      "lineNbr": 375,
      "author": {
        "id": 1
      },
      "writtenOn": "2021-07-29T02:19:23Z",
      "side": 1,
      "message": "See comment on earlier PS.",
      "revId": "406d739a88f57f5f609edc0e07f370872410053a",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    }
  ]
}