{
  "comments": [
    {
      "key": {
        "uuid": "3f79a3b5_0ac8444c",
        "filename": "doc/source/developer/specs/tenant-scoped-admin-web-API.rst",
        "patchSetId": 4
      },
      "lineNbr": 46,
      "author": {
        "id": 1
      },
      "writtenOn": "2018-11-13T15:23:56Z",
      "side": 1,
      "message": "One of the advantages of JWT is that other systems exist which can generate them.  For example, dex could be used to generate JWT based on oauth/openid connect logins: https://github.com/dexidp/dex\n\nWe should mention that here (and in the docs) so it\u0027s clear that even though Zuul has a utility to generate JWT, that isn\u0027t the only way -- that having another authentication mechanism generate JWT is probably the preferred way.",
      "revId": "bb7b9a28ac02fa779c52517803d71ab30e8da343",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f79a3b5_00bd8303",
        "filename": "doc/source/developer/specs/tenant-scoped-admin-web-API.rst",
        "patchSetId": 4
      },
      "lineNbr": 46,
      "author": {
        "id": 2903
      },
      "writtenOn": "2018-11-13T16:24:05Z",
      "side": 1,
      "message": "I want to concur. Zuul should not (ideally) implement it\u0027s own Identity Provider. Zuul should be a service provider that consumes JWT from an IDP.\n\nThe base installation may include a JWT provider internally to zuul, but it should be made as generic as possible to make it possible to consume (easily) JWT from a separate provider.\n\nIt is useful for at least testing/example purposes to have something internal. I also do want to warn/raise a concern that implementation of something internal often is not used solely for example and tends (especially) if it is the default need to grow to support many production cases.\n\nI hope the documentation will encourage/direct to use an external IDP generate JWT as the best production-scale mechanism.",
      "parentUuid": "3f79a3b5_0ac8444c",
      "revId": "bb7b9a28ac02fa779c52517803d71ab30e8da343",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f79a3b5_9f02d40c",
        "filename": "doc/source/developer/specs/tenant-scoped-admin-web-API.rst",
        "patchSetId": 4
      },
      "lineNbr": 46,
      "author": {
        "id": 7186
      },
      "writtenOn": "2018-12-18T22:20:56Z",
      "side": 1,
      "message": "I\u0027d like Zuul to maintain control over the claims in the JWT. This is desirable as it allows the format described below with authorized actions, which could be used by a web client and spare multiple calls to an authorization endpoint.\n\nDo services such as dex allow for overriding their JWTs with custom claims? I\u0027ve looked at the doc but didn\u0027t find any similar use cases.",
      "parentUuid": "3f79a3b5_00bd8303",
      "revId": "bb7b9a28ac02fa779c52517803d71ab30e8da343",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f79a3b5_805753cd",
        "filename": "doc/source/developer/specs/tenant-scoped-admin-web-API.rst",
        "patchSetId": 4
      },
      "lineNbr": 54,
      "author": {
        "id": 2903
      },
      "writtenOn": "2018-11-13T16:36:46Z",
      "side": 1,
      "message": "Is there an expected \u0027aud\u0027 that will indicate it is for Zuul?\n\nI worry this JWT content might be a bit minimal.",
      "revId": "bb7b9a28ac02fa779c52517803d71ab30e8da343",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f79a3b5_3a294e83",
        "filename": "doc/source/developer/specs/tenant-scoped-admin-web-API.rst",
        "patchSetId": 4
      },
      "lineNbr": 54,
      "author": {
        "id": 7186
      },
      "writtenOn": "2018-12-18T22:20:56Z",
      "side": 1,
      "message": "it is implicit from the \"zuul.actions\" claim but \"aud\" can be added. I didn\u0027t want to tie it to a URI for a specific instance, reasoning that Zuul might get a distributed architecture; you\u0027d then want the JWT to be consumable by every node of the distributed architecture.",
      "parentUuid": "3f79a3b5_805753cd",
      "revId": "bb7b9a28ac02fa779c52517803d71ab30e8da343",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f79a3b5_c0e78b10",
        "filename": "doc/source/developer/specs/tenant-scoped-admin-web-API.rst",
        "patchSetId": 4
      },
      "lineNbr": 135,
      "author": {
        "id": 2903
      },
      "writtenOn": "2018-11-13T16:36:46Z",
      "side": 1,
      "message": "As someone who has spent a serious amount of time dealing with using decorators for \"validation\" and/or \"authentication\", I highly recommend that this be avoided. Decorators are great in principal, but there ends up to be many cases where you need to handle ENFORCE outside of \"before\" or \"after\" the method/function. \n\nSuggest implementing a call that can be made directly in the function/method to avoid the long term pattern where callbacks or other complex methods are needed to ensure enforcement is flexible enough based upon the data in the JWT.\n\nDecorators in this case tend to be too simplistic in nature.",
      "range": {
        "startLine": 133,
        "startChar": 0,
        "endLine": 135,
        "endChar": 29
      },
      "revId": "bb7b9a28ac02fa779c52517803d71ab30e8da343",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f79a3b5_5a268ab5",
        "filename": "doc/source/developer/specs/tenant-scoped-admin-web-API.rst",
        "patchSetId": 4
      },
      "lineNbr": 135,
      "author": {
        "id": 7186
      },
      "writtenOn": "2018-12-18T22:20:56Z",
      "side": 1,
      "message": "Fair enough, I\u0027ll remove that in the next patch",
      "parentUuid": "3f79a3b5_c0e78b10",
      "range": {
        "startLine": 133,
        "startChar": 0,
        "endLine": 135,
        "endChar": 29
      },
      "revId": "bb7b9a28ac02fa779c52517803d71ab30e8da343",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f79a3b5_60b23708",
        "filename": "doc/source/developer/specs/tenant-scoped-admin-web-API.rst",
        "patchSetId": 4
      },
      "lineNbr": 225,
      "author": {
        "id": 2903
      },
      "writtenOn": "2018-11-13T16:36:46Z",
      "side": 1,
      "message": "What is the case where the JWT is valid but the user doesn\u0027t have authorization?\n\nKeep in mind HTTP 401 (Unauthorized) is an indicator that the user is unauthenticated. If the user is forbidden a 403 might be more correct.\n\nPlease ensure a WWW-Authenticate (with appropriate data) header is emitted with a 401.",
      "range": {
        "startLine": 225,
        "startChar": 58,
        "endLine": 225,
        "endChar": 61
      },
      "revId": "bb7b9a28ac02fa779c52517803d71ab30e8da343",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f79a3b5_c0954b40",
        "filename": "doc/source/developer/specs/tenant-scoped-admin-web-API.rst",
        "patchSetId": 4
      },
      "lineNbr": 291,
      "author": {
        "id": 2903
      },
      "writtenOn": "2018-11-13T16:36:46Z",
      "side": 1,
      "message": "Are you planning on limiting the TTL for the JWT by default?\n\nI would go as far and indicate that the default mode should be as narrow as possible, and extended time/scope should be extra (clearly indicated in the tool[s])",
      "range": {
        "startLine": 288,
        "startChar": 0,
        "endLine": 291,
        "endChar": 61
      },
      "revId": "bb7b9a28ac02fa779c52517803d71ab30e8da343",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f79a3b5_7a3826cb",
        "filename": "doc/source/developer/specs/tenant-scoped-admin-web-API.rst",
        "patchSetId": 4
      },
      "lineNbr": 291,
      "author": {
        "id": 7186
      },
      "writtenOn": "2018-12-18T22:20:56Z",
      "side": 1,
      "message": "If the JWT is generated somewhere else, do we have control on this?",
      "parentUuid": "3f79a3b5_c0954b40",
      "range": {
        "startLine": 288,
        "startChar": 0,
        "endLine": 291,
        "endChar": 61
      },
      "revId": "bb7b9a28ac02fa779c52517803d71ab30e8da343",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f79a3b5_2072ff4c",
        "filename": "doc/source/developer/specs/tenant-scoped-admin-web-API.rst",
        "patchSetId": 4
      },
      "lineNbr": 295,
      "author": {
        "id": 2903
      },
      "writtenOn": "2018-11-13T16:36:46Z",
      "side": 1,
      "message": "I would expand on the concerns with nodepool and autohold interactions (at least in documentation) as it stands it would be hard for an operator to identify the concerns.",
      "range": {
        "startLine": 293,
        "startChar": 0,
        "endLine": 295,
        "endChar": 57
      },
      "revId": "bb7b9a28ac02fa779c52517803d71ab30e8da343",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    }
  ]
}