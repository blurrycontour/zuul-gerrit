{
  "comments": [
    {
      "key": {
        "uuid": "7faddb67_a9002302",
        "filename": "zuul/cmd/executor.py",
        "patchSetId": 2
      },
      "lineNbr": 48,
      "author": {
        "id": 7118
      },
      "writtenOn": "2019-08-23T07:04:50Z",
      "side": 1,
      "message": "does this need to be sort of registered for the shutdown path (in executor/server.py)?  otherwise maybe this jumps in an kills the executor when it\u0027s shutting down?",
      "revId": "e725af152631483db14c8d146108161f95770681",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7faddb67_544fc3bd",
        "filename": "zuul/cmd/executor.py",
        "patchSetId": 2
      },
      "lineNbr": 48,
      "author": {
        "id": 16068
      },
      "writtenOn": "2019-08-23T12:54:45Z",
      "side": 1,
      "message": "I agree that we should include stopping this into the shutdown procedure. Otherwise there could be a race where this kicks in and terminates the executor non-gracefully.",
      "parentUuid": "7faddb67_a9002302",
      "revId": "e725af152631483db14c8d146108161f95770681",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7faddb67_ed485d8b",
        "filename": "zuul/cmd/executor.py",
        "patchSetId": 2
      },
      "lineNbr": 48,
      "author": {
        "id": 4146
      },
      "writtenOn": "2019-08-23T18:06:22Z",
      "side": 1,
      "message": "The way the fork is done below that race should be avoided. The child log streamer process waits for the parent\u0027s pipe to close then shuts itself down. That should avoid this race. However, if we want belts and suspenders for this we can add a stop flag that the shutdown of the executor sets.",
      "parentUuid": "7faddb67_544fc3bd",
      "revId": "e725af152631483db14c8d146108161f95770681",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7faddb67_74cd1f2f",
        "filename": "zuul/cmd/executor.py",
        "patchSetId": 2
      },
      "lineNbr": 53,
      "author": {
        "id": 16068
      },
      "writtenOn": "2019-08-23T12:54:45Z",
      "side": 1,
      "message": "I think we should try to gracefully stop the executor to give it a chance to abort all jobs. As a fallback we can still directly exit after a grace period.",
      "range": {
        "startLine": 53,
        "startChar": 16,
        "endLine": 53,
        "endChar": 27
      },
      "revId": "e725af152631483db14c8d146108161f95770681",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    }
  ]
}