- pipeline:
    name: gate
    manager: independent
    require:
      bitbucket:
        canMerge: True
        open: True
    trigger:
      bitbucket:
        - event: bb-pr
          action:
            - opened
            - updated
    success:
      bitbucket:
        merge: True
    failure:
      bitbucket:
        merge: False

- job:
    name: base
    parent: null
    run: playbooks/base.yaml

- job:
    name: project-test1
    run: playbooks/project-test1.yaml

- job:
    name: project-test2
    run: playbooks/project-test2.yaml

- job:
    name: project-merge
    run: playbooks/project-merge.yaml

- project:
    name: project/repo
    gate:
      jobs:
        - project-merge
        - project-test1:
            dependencies: project-merge
        - project-test2:
            dependencies: project-merge
