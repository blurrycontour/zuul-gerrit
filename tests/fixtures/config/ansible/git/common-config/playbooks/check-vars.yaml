- hosts: ubuntu-xenial
  tasks:
    - name: Assert nodepool variables are valid.
      assert:
        that:
          - nodepool.az == 'test-az'
          - nodepool.region == 'test-region'
          - nodepool.provider == 'test-provider'

    - name: Assert zuul-executor variables are valid.
      assert:
        that:
          - zuul.executor.hostname is defined
          - zuul.executor.src_root is defined
          - zuul.executor.log_root is defined

    - name: Assert zuul.project variables are valid.
      assert:
        that:
          - zuul.project.name == 'org/project'
          - zuul.project.canonical_hostname == 'review.example.com'
          - zuul.project.canonical_name == 'review.example.com/org/project'

    - debug:
        msg: "vartest secret {{ vartest_secret }}"

    - name: Assert variable precedence.
      assert:
        that:
          - vartest_job == 'vartest_job'
          - vartest_secret.value == 'vartest_secret'
          - vartest_site == 'vartest_site'