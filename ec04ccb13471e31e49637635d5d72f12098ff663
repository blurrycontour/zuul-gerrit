{
  "comments": [
    {
      "key": {
        "uuid": "ff570b3c_c8d5c2bb",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 17,
      "author": {
        "id": 1
      },
      "writtenOn": "2020-05-11T16:05:25Z",
      "side": 1,
      "message": "Can you describe how this process would look?  I don\u0027t see any description below of how a user would invoke zuul-runner to run a job that has already run.  I\u0027m curious if you could point it at a zuul inventory file and have it automatically work?  How would it reproduce the previous merge state?",
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_3ec63869",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 17,
      "author": {
        "id": 9311
      },
      "writtenOn": "2020-05-11T17:18:55Z",
      "side": 1,
      "message": "Next PS mention that this can be done using an inventory file indeed, or using the `--change-url` command line argument too.\n\nTo reproduce the exact merge state, we would need to make that information available, otherwise I think it\u0027s ok to use the same strategy and use the current state of required project.",
      "parentUuid": "ff570b3c_c8d5c2bb",
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bf51134e_a925025f",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 17,
      "author": {
        "id": 1
      },
      "writtenOn": "2020-07-17T16:14:29Z",
      "side": 1,
      "message": "I think for the use case of \"recreate a build that failed in the gate\" it\u0027s important to have the exact merge state of the projects.  Zuul has that from the mergers (the mergers tell the executors exactly what to do), so we can expose that.",
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_28da7ee8",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 20,
      "author": {
        "id": 1
      },
      "writtenOn": "2020-05-11T16:05:25Z",
      "side": 1,
      "message": "This seems to be fairly well described below.",
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_651c9f6a",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 28,
      "author": {
        "id": 27336
      },
      "writtenOn": "2020-05-11T15:07:00Z",
      "side": 1,
      "message": "a jobs?",
      "range": {
        "startLine": 28,
        "startChar": 0,
        "endLine": 28,
        "endChar": 21
      },
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_7ea550b5",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 28,
      "author": {
        "id": 9311
      },
      "writtenOn": "2020-05-11T17:18:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ff570b3c_651c9f6a",
      "range": {
        "startLine": 28,
        "startChar": 0,
        "endLine": 28,
        "endChar": 21
      },
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_c5b64bda",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 39,
      "author": {
        "id": 16068
      },
      "writtenOn": "2020-05-11T15:29:20Z",
      "side": 1,
      "message": "shall require",
      "range": {
        "startLine": 39,
        "startChar": 22,
        "endLine": 39,
        "endChar": 30
      },
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_1e941444",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 39,
      "author": {
        "id": 9311
      },
      "writtenOn": "2020-05-11T17:18:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ff570b3c_c5b64bda",
      "range": {
        "startLine": 39,
        "startChar": 22,
        "endLine": 39,
        "endChar": 30
      },
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_08d7bac1",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 42,
      "author": {
        "id": 1
      },
      "writtenOn": "2020-05-11T16:05:25Z",
      "side": 1,
      "message": "I don\u0027t see anything about this below.  How does the user go about doing this?",
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_1ea2549b",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 42,
      "author": {
        "id": 9311
      },
      "writtenOn": "2020-05-11T17:18:55Z",
      "side": 1,
      "message": "Next PS includes an example.",
      "parentUuid": "ff570b3c_08d7bac1",
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_123d2bbb",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 64,
      "author": {
        "id": 16068
      },
      "writtenOn": "2020-05-11T14:34:38Z",
      "side": 1,
      "message": "How does this work together with base jobs (e.g. log upload). Those secrets are generally not available to any user. I guess there is some filtering required to limit the playbooks that are being run? Or do we need some sort of job attribute that allows certain playbooks to be executed locally?",
      "range": {
        "startLine": 63,
        "startChar": 0,
        "endLine": 64,
        "endChar": 32
      },
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_c5880b21",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 64,
      "author": {
        "id": 9311
      },
      "writtenOn": "2020-05-11T15:25:21Z",
      "side": 1,
      "message": "I think we said that zuul-runner would not run post action. Alternatively we can detect such `site` secret and provide drop-in replacement that uses localhost, one of the initial implementation did that, but that is a bit tricky and skipping post-run seems easier.",
      "parentUuid": "ff570b3c_123d2bbb",
      "range": {
        "startLine": 63,
        "startChar": 0,
        "endLine": 64,
        "endChar": 32
      },
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_45d7dbee",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 64,
      "author": {
        "id": 16068
      },
      "writtenOn": "2020-05-11T15:29:20Z",
      "side": 1,
      "message": "Having zuul-runner not executing post playbooks would solve this issue mostly I guess. But I think we should mention that in the spec as well.",
      "parentUuid": "ff570b3c_c5880b21",
      "range": {
        "startLine": 63,
        "startChar": 0,
        "endLine": 64,
        "endChar": 32
      },
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_68e476ad",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 64,
      "author": {
        "id": 1
      },
      "writtenOn": "2020-05-11T16:05:25Z",
      "side": 1,
      "message": "I think post actions are going to be important for people to test (fetching logs from test nodes, etc).  Maybe we could add 2 options, both disabled by default:\n\n--post: run all post playbooks except the base job post playbook\n--base-post: run the base job post playbook\n\nBut having an option to supply secrets may still be important.  For example, that could be very useful testing a docker upload job.  But maybe they can just be supplied as extra job variables.  How that looks may depend on what the input inventory looks like.",
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_5eda0c17",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 64,
      "author": {
        "id": 9311
      },
      "writtenOn": "2020-05-11T17:18:55Z",
      "side": 1,
      "message": "Or that could be implemented using a single `--post matcher` where matcher is a regular expression that select the playbook by name. Perhaps that can be done as a follow-up?",
      "parentUuid": "ff570b3c_68e476ad",
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bf51134e_2252afdf",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 64,
      "author": {
        "id": 16068
      },
      "writtenOn": "2020-07-17T12:07:36Z",
      "side": 1,
      "message": "I think just --post won\u0027t work in our environment because we have a stack of base jobs using post playbooks. I like the idea about the \u0027--post \u003cmatcher\u003e\u0027. In think this should be an option that can be repeated to make it possible to select the post playbooks that are interesting to the user (same with --pre \u003cmatcher\u003e\u0027.",
      "parentUuid": "ff570b3c_5eda0c17",
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bf51134e_892abe29",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 64,
      "author": {
        "id": 1
      },
      "writtenOn": "2020-07-17T16:14:29Z",
      "side": 1,
      "message": "I think the matcher idea could work, but uniquely identifying a post playbook may be tricky.  Most of ours are named \"post.yaml\".  They would probably need to be fully qualified with the name of the repo and the path.\n\nStill, I think specifying that you want to run everything except the log collection is a common enough use case that it should be easy, and adding \"--post\" 9 times for the 9 playbooks that you do want to run just to avoid running the 10th doesn\u0027t sound easy.  So if we do that, we may want to also have an inverse option, so a user could just say \"--no-post opendev.org/base-jobs/playbooks/base/logs.yaml\".\n\nFurther, it seems that if we\u0027re specifying the full path, we probably don\u0027t need to distinguish between pre and post?  Maybe we can just say \"--no-playbook\"?  It\u0027s unlikely that the same playbook would be used in both pre and post.  At least, no more likely than the same playbook showing up twice in pre or post.\n\nFinally, maybe we could have an option to list the playbooks with numeric indexes.  So you could say \"zuul-runner --list-playbooks\" and it would print out:\n\n0: opendev.org/base-jobs/playbooks/pre.yaml\n...\n10: opendev.org/base-jobs/playbooks/post.yaml\n\nWe could then say \"--no-playbook 10\" or \"--no-playbook -1\", or \"--playbook 1..9\".",
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_48e1b29a",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 109,
      "author": {
        "id": 1
      },
      "writtenOn": "2020-05-11T16:05:25Z",
      "side": 1,
      "message": "It seems weird to have a \u0027depends-on\u0027 option with no change.  Perhaps the option should just be called \"--change-url\", and it could be a multiple-value option that points to change urls.",
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ff570b3c_3ed758f0",
        "filename": "doc/source/reference/developer/specs/zuul-runner.rst",
        "patchSetId": 6
      },
      "lineNbr": 109,
      "author": {
        "id": 9311
      },
      "writtenOn": "2020-05-11T17:18:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ff570b3c_48e1b29a",
      "revId": "ec04ccb13471e31e49637635d5d72f12098ff663",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543",
      "unresolved": false
    }
  ]
}